<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathJax</title>
    <link rel="stylesheet" href="main.css">
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
    <p id="mathoutput">Enter your math expressions below to display here. For example:<br>$$a^2+b^2=c^2$$</p>
    <select title="Autoformat" id="autoformat">
        <option value="True">True</option>
        <option value="False">False</option>
    </select>
    <p>Enter MaxJax Input</p>
    <textarea id="mathinput" placeholder="Enter a math expression here"></textarea>

    <p>Helpful <a href="https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference" rel="noopener" target="_blank" >Guide</a></p>
    
    <br>
    <br>

    <div id="otherresources">
        <a href="index.html">Calculator</a>
        <a href="unitconverter.html">Unit Converter</a>
        <a href="mathtester.html">Math Tester</a>
        <a href="mathjax.html">Math Formatter</a>
    </div>

    <script>
        let autoformat = true;
        alert("Autoformat is now " + autoformat);   
        document.getElementById("autoformat").addEventListener("change", function() {
            if (document.getElementById("autoformat").value == "True") {
                autoformat = true;
            } else {
                autoformat = false;
            }
            alert("Autoformat is now " + autoformat);
        });

        document.getElementById("mathinput").addEventListener("input", function() {
            var math = document.getElementById("mathinput").value;
            const default_output = "Enter your math expressions below to display here. For example:\n$$a^2+b^2=c^2$$";
            
            // Check if beginning of math expression and end of math expression contain $$, if not, add them
            if (math !== "" && math !== "\\" && math !== null && autoformat) {
                if (math.substring(0, 2) !== "$$") {
                    math = "$$" + math;
                }
                if (math.substring(math.length - 2) !== "$$") {
                    math = math + "$$";
                }
            }

            // Show default output
            if (math == "" || math === null) {
                math = default_output;
            }

            document.getElementById("mathoutput").innerHTML = math;
            MathJax.typeset();
        });
    </script>

    <style>
        #mathoutput {
            border: 1px solid black;
            padding: 10px;
            margin: 10px;
        }

        #mathinput {
            font-size: 20px;
            background-color: lightgray;
            width: 50%;
            height: 20vh;
            border: 1px solid black;
            padding: 10px;
            margin: 10px;
        }
    </style>
    
</body>
</html>